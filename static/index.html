<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>iCalendar import - ITCarlow Timetable</title>

  <link href="css/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="css/index.css" rel="stylesheet" type="text/css">
</head>
<body>
  <div class="content">
    <h1>iCalendar exporter</h1>
    <p>
      This service allows you to convert IT Carlow timetables to the iCalendar format.

      This means you can add your timetables to your android or apple smartphone through Google Calendar.
    </p>

    <div class="step" id="step1">
      <h2>Select your timetable</h2>
      <form>

      </form>
    </div>

    <div class="step" id="step2">
      <h2>Add to Google Calendar</h2>

    </div>

    <div class="step" id="step3">
      <h2>Get it on your device</h2>

    </div>




      <div class="tab-pane" id="instructions">
        <h2>iPhone</h2>
        <ol>
          <li>
            Copy the link from above.
          </li>
          <li>
            Go to <a href="https://google.com/calendar/">Google Calendar</a>
          </li>
          <li>
            On the left hand column of the page, click the arrow beside "Other Calendars", then "Add by URL"
          </li>
          <li>
            Paste the link from step one into the input and click "Add Calendar".
          </li>
          <li>
            Once the timetable has successfully been imported it should appear on your calendar
          </li>
          <li>
            To import the calendar on your iPhone/iPod go to <a href="https://www.google.com/calendar/iphoneselect">https://www.google.com/calendar/iphoneselect</a> and select the calendar you imported. Then click "Save"
          </li>
          <li>
            Go to your iPhone/iPod and open the iCal app. Your calendar should appear once you click the reload button.
          </li>
        </ol>
        <h2>Android</h2>
        <ol>
          <li>
            Copy the link from above.
          </li>
          <li>
            Go to <a href="https://google.com/calendar/">Google Calendar</a>
          </li>
          <li>
            On the left hand column of the page, click the arrow beside "Other Calendars", then "Add by URL".
          </li>
          <li>
            Paste the link from step one into the input and click "Add Calendar".
          </li>
          <li>
            Once the timetable has successfully been imported it should appear on your calendar.
          </li>
          <li>
            The timetable should also appear on the calendar app on your phone, although you may need to
            close and reopen it to update.
          </li>
        </ol>

      </div>
    </div>

  </div>


  <footer>
  </footer>


  <script src="js/depts.js"></script>
  <script src="js/jquery-1.8.2.min.js"></script>
  <script src="js/bootstrap.min.js"></script>

  <script>
    (function() {
        var selectedDept,
          selectedType;





      function updateItems() {
        selectedDept = depts[departmentsEl.val()];
        selectedType = typeEl.filter(":checked").val();

        var typeList = selectedDept[selectedType],
          // create a document fragment for faster insertion
          fragment = document.createDocumentFragment();

        for(var i = 0, il = typeList.length; i < il; i++) {
          var type = typeList[i];
          $("<option />").val(type.id).text(type.name).appendTo(fragment);
        }

        itemsEl.html("").append(fragment);

        updateSelectLink();
      }

      function updateSelectLink() {
        var url = document.location.href + "timetable.ics?item=" + itemsEl.val() + "&type=" + selectedType;
        calendarLink.val(url);
      }
      function updateURLLink() {
        var url = document.location.href + "timetable.ics?url=" + urlCalendarInput.val();
        calendarLink.val(url);
      }

      var departmentsEl = $("#department").on("change", updateItems),
        typeEl = $("[name=type]").on("change", updateItems),
        itemsEl = $("#items").on("change", updateSelectLink),
        urlEl = $("#urls"),
        urlCalendarInput = $("#timetable-url").on("change keyup", updateURLLink),
        calendarLink = $("#calendar-link");

      // populate departments first
      // they will always be populated so we won't have to change them around again
      for(var deptID in depts) {
        var dept = depts[deptID];
        $("<option />").val(deptID).text(dept.name).appendTo(departmentsEl);
      }

      updateItems();

    $('#tab-headers a').click(function (e) {
      e.preventDefault();
      $(this).tab('show');
    })


    })();
  </script>
</body>
</html>